// Generated by dafny2js
// Do not edit manually - regenerate from Dafny sources

import BigNumber from 'bignumber.js';

// Configure BigNumber as Dafny expects
BigNumber.config({ MODULO_MODE: BigNumber.EUCLID });

// Import the generated code as raw text
import dafnyCode from './TodoMultiProjectEffect.cjs?raw';

// Set up the environment and evaluate the Dafny code
const require = (mod: string) => {
  if (mod === 'bignumber.js') return BigNumber;
  throw new Error(`Unknown module: ${mod}`);
};

// Create a function that evaluates the code with proper scope
const initDafny = new Function('require', `
  ${dafnyCode}
  return { _dafny, TodoDomain, TodoMultiProjectDomain, TodoMultiProjectEffectStateMachine, TodoMultiProjectEffectAppCore };
`);

const { _dafny, TodoDomain, TodoMultiProjectDomain, TodoMultiProjectEffectStateMachine, TodoMultiProjectEffectAppCore } = initDafny(require);

// ============================================================================
// Helpers
// ============================================================================

// deno-lint-ignore no-explicit-any
const seqToArray = (seq: any): any[] => {
  const arr = [];
  for (let i = 0; i < seq.length; i++) {
    arr.push(seq[i]);
  }
  return arr;
};

// deno-lint-ignore no-explicit-any
const toNumber = (bn: any): number => {
  if (bn && typeof bn.toNumber === 'function') {
    return bn.toNumber();
  }
  return bn;
};

// deno-lint-ignore no-explicit-any
const dafnyStringToJs = (seq: any): string => {
  if (typeof seq === 'string') return seq;
  if (seq.toVerbatimString) return seq.toVerbatimString(false);
  return Array.from(seq).join('');
};


// ============================================================================
// TypeScript Type Definitions (JSON representation)
// ============================================================================

export type Option<T> =
  | { type: 'None' }
  | { type: 'Some'; value: unknown };

export interface Date {
  year: number;
  month: number;
  day: number;
}

export interface Task {
  title: string;
  notes: string;
  completed: boolean;
  starred: boolean;
  dueDate: Option<Date>;
  assignees: string[];
  tags: number[];
  deleted: boolean;
  deletedBy: Option<string>;
  deletedFromList: Option<number>;
}

export interface Tag {
  name: string;
}

export type ProjectMode = 'Personal' | 'Collaborative';

export interface Model {
  mode: ProjectMode;
  owner: string;
  members: string[];
  lists: number[];
  listNames: Record<string, string>;
  tasks: Record<string, number[]>;
  taskData: Record<string, Task>;
  tags: Record<string, Tag>;
  nextListId: number;
  nextTaskId: number;
  nextTagId: number;
}

export type Err = 'MissingList' | 'MissingTask' | 'MissingTag' | 'MissingUser' | 'DuplicateList' | 'DuplicateTask' | 'DuplicateTag' | 'BadAnchor' | 'NotAMember' | 'PersonalProject' | 'AlreadyCollaborative' | 'CannotRemoveOwner' | 'TaskDeleted' | 'InvalidDate' | 'Rejected';

export type Place =
  | { type: 'AtEnd' }
  | { type: 'Before'; anchor: number }
  | { type: 'After'; anchor: number };

export type ListPlace =
  | { type: 'ListAtEnd' }
  | { type: 'ListBefore'; anchor: number }
  | { type: 'ListAfter'; anchor: number };

export type Action =
  | { type: 'NoOp' }
  | { type: 'AddList'; name: string }
  | { type: 'RenameList'; listId: number; newName: string }
  | { type: 'DeleteList'; listId: number }
  | { type: 'MoveList'; listId: number; listPlace: ListPlace }
  | { type: 'AddTask'; listId: number; title: string }
  | { type: 'EditTask'; taskId: number; title: string; notes: string }
  | { type: 'DeleteTask'; taskId: number; userId: string }
  | { type: 'RestoreTask'; taskId: number }
  | { type: 'MoveTask'; taskId: number; toList: number; taskPlace: Place }
  | { type: 'CompleteTask'; taskId: number }
  | { type: 'UncompleteTask'; taskId: number }
  | { type: 'StarTask'; taskId: number }
  | { type: 'UnstarTask'; taskId: number }
  | { type: 'SetDueDate'; taskId: number; dueDate: Option<Date> }
  | { type: 'AssignTask'; taskId: number; userId: string }
  | { type: 'UnassignTask'; taskId: number; userId: string }
  | { type: 'AddTagToTask'; taskId: number; tagId: number }
  | { type: 'RemoveTagFromTask'; taskId: number; tagId: number }
  | { type: 'CreateTag'; name: string }
  | { type: 'RenameTag'; tagId: number; newName: string }
  | { type: 'DeleteTag'; tagId: number }
  | { type: 'MakeCollaborative' }
  | { type: 'AddMember'; userId: string }
  | { type: 'RemoveMember'; userId: string };

export type ViewMode = 'SingleProject' | 'AllProjects';

export type SmartListType = 'Priority' | 'Logbook';

export type Result<T, E> =
  | { type: 'Ok'; value: unknown }
  | { type: 'Err'; error: unknown };

export type MultiAction =
  | { type: 'Single'; project: string; action: Action }
  | { type: 'MoveTaskTo'; srcProject: string; dstProject: string; taskId: number; dstList: number; anchor: Place }
  | { type: 'CopyTaskTo'; srcProject: string; dstProject: string; taskId: number; dstList: number }
  | { type: 'MoveListTo'; srcProject: string; dstProject: string; listId: number };

export interface MultiModel {
  projects: Record<string, Model>;
}

export type MultiErr =
  | { type: 'MissingProject'; projectId: string }
  | { type: 'SingleProjectError'; projectId: string; err: Err }
  | { type: 'CrossProjectError'; message: string };

export interface MultiClientState {
  baseVersions: Record<string, number>;
  present: MultiModel;
  pending: MultiAction[];
}

export type NetworkStatus = 'Online' | 'Offline';

export type EffectMode =
  | { type: 'Idle' }
  | { type: 'Dispatching'; retries: number };

export interface EffectState {
  network: NetworkStatus;
  mode: EffectMode;
  client: MultiClientState;
}

export type Event =
  | { type: 'UserAction'; action: MultiAction }
  | { type: 'DispatchAccepted'; newVersions: Record<string, number>; newModels: Record<string, Model> }
  | { type: 'DispatchConflict'; freshVersions: Record<string, number>; freshModels: Record<string, Model> }
  | { type: 'DispatchRejected'; freshVersions: Record<string, number>; freshModels: Record<string, Model> }
  | { type: 'RealtimeUpdate'; projectId: string; version: number; model: Model }
  | { type: 'NetworkError' }
  | { type: 'NetworkRestored' }
  | { type: 'ManualGoOffline' }
  | { type: 'ManualGoOnline' }
  | { type: 'Tick' };

export type Command =
  | { type: 'NoOp' }
  | { type: 'SendDispatch'; touchedProjects: string[]; baseVersions: Record<string, number>; action: MultiAction }
  | { type: 'FetchFreshState'; projects: string[] };

// ============================================================================
// Dafny Runtime Types (actual Dafny runtime object shapes)
// ============================================================================

// Base Dafny runtime types
type DafnyInt = InstanceType<typeof BigNumber>;
interface DafnySeq<T = unknown> {
  readonly length: number;
  readonly [index: number]: T;
  toVerbatimString?(asLiteral: boolean): string;
  map<U>(fn: (x: T) => U): U[];
}
interface DafnySet<T = unknown> { readonly Elements: Iterable<T>; }
interface DafnyMap<K = unknown, V = unknown> {
  readonly Keys: DafnySet<K>;
  get(key: K): V;
  contains(key: K): boolean;
}

type DafnyOption<T> = { readonly is_None: true; readonly is_Some: false } | { readonly is_None: false; readonly is_Some: true; readonly dtor_value: T };

interface DafnyDate {
  readonly is_Date: true;
  readonly dtor_year: DafnyInt;
  readonly dtor_month: DafnyInt;
  readonly dtor_day: DafnyInt;
}

interface DafnyTask {
  readonly is_Task: true;
  readonly dtor_title: DafnySeq;
  readonly dtor_notes: DafnySeq;
  readonly dtor_completed: boolean;
  readonly dtor_starred: boolean;
  readonly dtor_dueDate: DafnyOption<DafnyDate>;
  readonly dtor_assignees: DafnySet<DafnySeq>;
  readonly dtor_tags: DafnySet<DafnyInt>;
  readonly dtor_deleted: boolean;
  readonly dtor_deletedBy: DafnyOption<DafnySeq>;
  readonly dtor_deletedFromList: DafnyOption<DafnyInt>;
}

interface DafnyTag {
  readonly is_Tag: true;
  readonly dtor_name: DafnySeq;
}

type DafnyProjectMode = { readonly is_Personal: true; readonly is_Collaborative: false } | { readonly is_Personal: false; readonly is_Collaborative: true };

interface DafnyModel {
  readonly is_Model: true;
  readonly dtor_mode: DafnyProjectMode;
  readonly dtor_owner: DafnySeq;
  readonly dtor_members: DafnySet<DafnySeq>;
  readonly dtor_lists: DafnySeq<DafnyInt>;
  readonly dtor_listNames: DafnyMap<DafnyInt, DafnySeq>;
  readonly dtor_tasks: DafnyMap<DafnyInt, DafnySeq<DafnyInt>>;
  readonly dtor_taskData: DafnyMap<DafnyInt, DafnyTask>;
  readonly dtor_tags: DafnyMap<DafnyInt, DafnyTag>;
  readonly dtor_nextListId: DafnyInt;
  readonly dtor_nextTaskId: DafnyInt;
  readonly dtor_nextTagId: DafnyInt;
}

type DafnyErr = { readonly is_MissingList: true; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: true; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: true; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: true; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: true; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: true; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: true; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: true; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: true; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: true; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: true; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: true; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: true; readonly is_InvalidDate: false; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: true; readonly is_Rejected: false } | { readonly is_MissingList: false; readonly is_MissingTask: false; readonly is_MissingTag: false; readonly is_MissingUser: false; readonly is_DuplicateList: false; readonly is_DuplicateTask: false; readonly is_DuplicateTag: false; readonly is_BadAnchor: false; readonly is_NotAMember: false; readonly is_PersonalProject: false; readonly is_AlreadyCollaborative: false; readonly is_CannotRemoveOwner: false; readonly is_TaskDeleted: false; readonly is_InvalidDate: false; readonly is_Rejected: true };

type DafnyPlace = { readonly is_AtEnd: true; readonly is_Before: false; readonly is_After: false } | { readonly is_AtEnd: false; readonly is_Before: true; readonly is_After: false; readonly dtor_anchor: DafnyInt } | { readonly is_AtEnd: false; readonly is_Before: false; readonly is_After: true; readonly dtor_anchor: DafnyInt };

type DafnyListPlace = { readonly is_ListAtEnd: true; readonly is_ListBefore: false; readonly is_ListAfter: false } | { readonly is_ListAtEnd: false; readonly is_ListBefore: true; readonly is_ListAfter: false; readonly dtor_anchor: DafnyInt } | { readonly is_ListAtEnd: false; readonly is_ListBefore: false; readonly is_ListAfter: true; readonly dtor_anchor: DafnyInt };

type DafnyAction = { readonly is_NoOp: true; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false } | { readonly is_NoOp: false; readonly is_AddList: true; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_name: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: true; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_listId: DafnyInt; readonly dtor_newName: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: true; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_listId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: true; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_listId: DafnyInt; readonly dtor_listPlace: DafnyListPlace } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: true; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_listId: DafnyInt; readonly dtor_title: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: true; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_title: DafnySeq; readonly dtor_notes: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: true; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_userId: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: true; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: true; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_toList: DafnyInt; readonly dtor_taskPlace: DafnyPlace } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: true; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: true; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: true; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: true; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: true; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_dueDate: DafnyOption<DafnyDate> } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: true; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_userId: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: true; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_userId: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: true; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_tagId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: true; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_taskId: DafnyInt; readonly dtor_tagId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: true; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_name: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: true; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_tagId: DafnyInt; readonly dtor_newName: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: true; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: false; readonly dtor_tagId: DafnyInt } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: true; readonly is_AddMember: false; readonly is_RemoveMember: false } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: true; readonly is_RemoveMember: false; readonly dtor_userId: DafnySeq } | { readonly is_NoOp: false; readonly is_AddList: false; readonly is_RenameList: false; readonly is_DeleteList: false; readonly is_MoveList: false; readonly is_AddTask: false; readonly is_EditTask: false; readonly is_DeleteTask: false; readonly is_RestoreTask: false; readonly is_MoveTask: false; readonly is_CompleteTask: false; readonly is_UncompleteTask: false; readonly is_StarTask: false; readonly is_UnstarTask: false; readonly is_SetDueDate: false; readonly is_AssignTask: false; readonly is_UnassignTask: false; readonly is_AddTagToTask: false; readonly is_RemoveTagFromTask: false; readonly is_CreateTag: false; readonly is_RenameTag: false; readonly is_DeleteTag: false; readonly is_MakeCollaborative: false; readonly is_AddMember: false; readonly is_RemoveMember: true; readonly dtor_userId: DafnySeq };

type DafnyViewMode = { readonly is_SingleProject: true; readonly is_AllProjects: false } | { readonly is_SingleProject: false; readonly is_AllProjects: true };

type DafnySmartListType = { readonly is_Priority: true; readonly is_Logbook: false } | { readonly is_Priority: false; readonly is_Logbook: true };

type DafnyResult<T, E> = { readonly is_Ok: true; readonly is_Err: false; readonly dtor_value: T } | { readonly is_Ok: false; readonly is_Err: true; readonly dtor_error: E };

type DafnyMultiAction = { readonly is_Single: true; readonly is_MoveTaskTo: false; readonly is_CopyTaskTo: false; readonly is_MoveListTo: false; readonly dtor_project: DafnySeq; readonly dtor_action: DafnyAction } | { readonly is_Single: false; readonly is_MoveTaskTo: true; readonly is_CopyTaskTo: false; readonly is_MoveListTo: false; readonly dtor_srcProject: DafnySeq; readonly dtor_dstProject: DafnySeq; readonly dtor_taskId: DafnyInt; readonly dtor_dstList: DafnyInt; readonly dtor_anchor: DafnyPlace } | { readonly is_Single: false; readonly is_MoveTaskTo: false; readonly is_CopyTaskTo: true; readonly is_MoveListTo: false; readonly dtor_srcProject: DafnySeq; readonly dtor_dstProject: DafnySeq; readonly dtor_taskId: DafnyInt; readonly dtor_dstList: DafnyInt } | { readonly is_Single: false; readonly is_MoveTaskTo: false; readonly is_CopyTaskTo: false; readonly is_MoveListTo: true; readonly dtor_srcProject: DafnySeq; readonly dtor_dstProject: DafnySeq; readonly dtor_listId: DafnyInt };

interface DafnyMultiModel {
  readonly is_MultiModel: true;
  readonly dtor_projects: DafnyMap<DafnySeq, DafnyModel>;
}

type DafnyMultiErr = { readonly is_MissingProject: true; readonly is_SingleProjectError: false; readonly is_CrossProjectError: false; readonly dtor_projectId: DafnySeq } | { readonly is_MissingProject: false; readonly is_SingleProjectError: true; readonly is_CrossProjectError: false; readonly dtor_projectId: DafnySeq; readonly dtor_err: DafnyErr } | { readonly is_MissingProject: false; readonly is_SingleProjectError: false; readonly is_CrossProjectError: true; readonly dtor_message: DafnySeq };

interface DafnyMultiClientState {
  readonly is_MultiClientState: true;
  readonly dtor_baseVersions: DafnyMap<DafnySeq, DafnyInt>;
  readonly dtor_present: DafnyMultiModel;
  readonly dtor_pending: DafnySeq<DafnyMultiAction>;
}

type DafnyNetworkStatus = { readonly is_Online: true; readonly is_Offline: false } | { readonly is_Online: false; readonly is_Offline: true };

type DafnyEffectMode = { readonly is_Idle: true; readonly is_Dispatching: false } | { readonly is_Idle: false; readonly is_Dispatching: true; readonly dtor_retries: DafnyInt };

interface DafnyEffectState {
  readonly is_EffectState: true;
  readonly dtor_network: DafnyNetworkStatus;
  readonly dtor_mode: DafnyEffectMode;
  readonly dtor_client: DafnyMultiClientState;
}

type DafnyEvent = { readonly is_UserAction: true; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: false; readonly dtor_action: DafnyMultiAction } | { readonly is_UserAction: false; readonly is_DispatchAccepted: true; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: false; readonly dtor_newVersions: DafnyMap<DafnySeq, DafnyInt>; readonly dtor_newModels: DafnyMap<DafnySeq, DafnyModel> } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: true; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: false; readonly dtor_freshVersions: DafnyMap<DafnySeq, DafnyInt>; readonly dtor_freshModels: DafnyMap<DafnySeq, DafnyModel> } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: true; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: false; readonly dtor_freshVersions: DafnyMap<DafnySeq, DafnyInt>; readonly dtor_freshModels: DafnyMap<DafnySeq, DafnyModel> } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: true; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: false; readonly dtor_projectId: DafnySeq; readonly dtor_version: DafnyInt; readonly dtor_model: DafnyModel } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: true; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: false } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: true; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: false } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: true; readonly is_ManualGoOnline: false; readonly is_Tick: false } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: true; readonly is_Tick: false } | { readonly is_UserAction: false; readonly is_DispatchAccepted: false; readonly is_DispatchConflict: false; readonly is_DispatchRejected: false; readonly is_RealtimeUpdate: false; readonly is_NetworkError: false; readonly is_NetworkRestored: false; readonly is_ManualGoOffline: false; readonly is_ManualGoOnline: false; readonly is_Tick: true };

type DafnyCommand = { readonly is_NoOp: true; readonly is_SendDispatch: false; readonly is_FetchFreshState: false } | { readonly is_NoOp: false; readonly is_SendDispatch: true; readonly is_FetchFreshState: false; readonly dtor_touchedProjects: DafnySet<DafnySeq>; readonly dtor_baseVersions: DafnyMap<DafnySeq, DafnyInt>; readonly dtor_action: DafnyMultiAction } | { readonly is_NoOp: false; readonly is_SendDispatch: false; readonly is_FetchFreshState: true; readonly dtor_projects: DafnySet<DafnySeq> };

// ============================================================================
// Datatype Conversions
// ============================================================================

// deno-lint-ignore no-explicit-any
const optionFromJson = <T>(json: any, T_fromJson: (x: any) => T): DafnyOption<T> => {
  // Handle null/undefined (DB compatibility with --null-options)
  if (json === null || json === undefined) {
    return TodoDomain.Option.create_None();
  }
  // Handle raw values without type tag (DB stores unwrapped Some values)
  if (!json.type) {
    return TodoDomain.Option.create_Some(T_fromJson(json));
  }
  switch (json.type) {
    case 'None': {
      return TodoDomain.Option.create_None();
    }
    case 'Some': {
      return TodoDomain.Option.create_Some(
        T_fromJson(json.value)
      );
    }
    default:
      throw new Error(`Unknown Option type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const optionToJson = <T>(value: any, T_toJson: (x: any) => any): Option<T> => {
  if (value.is_None) {
    return { type: 'None' };
  } else if (value.is_Some) {
    return {
      type: 'Some',
      value: T_toJson(value.dtor_value)
    };
  }
  throw new Error('Unknown Option variant');
};

// deno-lint-ignore no-explicit-any
const dateFromJson = (json: any): DafnyDate => {
  return TodoDomain.Date.create_Date(
    new BigNumber(json.year),
    new BigNumber(json.month),
    new BigNumber(json.day)
  );
};

// deno-lint-ignore no-explicit-any
const dateToJson = (value: any): Date => {
  return {
    year: toNumber(value.dtor_year),
    month: toNumber(value.dtor_month),
    day: toNumber(value.dtor_day)
  };
};

// deno-lint-ignore no-explicit-any
const taskFromJson = (json: any): DafnyTask => {
  return TodoDomain.Task.create_Task(
    _dafny.Seq.UnicodeFromString(json.title),
    _dafny.Seq.UnicodeFromString(json.notes),
    json.completed,
    json.starred,
    optionFromJson(json.dueDate, dateFromJson),
    _dafny.Set.fromElements(...(json.assignees || []).map((x: any) => _dafny.Seq.UnicodeFromString(x))),
    _dafny.Set.fromElements(...(json.tags || []).map((x: any) => new BigNumber(x))),
    json.deleted,
    optionFromJson(json.deletedBy, (x: any) => _dafny.Seq.UnicodeFromString(x)),
    optionFromJson(json.deletedFromList, (x: any) => new BigNumber(x))
  );
};

// deno-lint-ignore no-explicit-any
const taskToJson = (value: any): Task => {
  return {
    title: dafnyStringToJs(value.dtor_title),
    notes: dafnyStringToJs(value.dtor_notes),
    completed: value.dtor_completed,
    starred: value.dtor_starred,
    dueDate: optionToJson(value.dtor_dueDate, dateToJson),
    assignees: Array.from(value.dtor_assignees.Elements).map((x: any) => dafnyStringToJs(x)),
    tags: Array.from(value.dtor_tags.Elements).map((x: any) => toNumber(x)),
    deleted: value.dtor_deleted,
    deletedBy: optionToJson(value.dtor_deletedBy, dafnyStringToJs),
    deletedFromList: optionToJson(value.dtor_deletedFromList, toNumber)
  };
};

// deno-lint-ignore no-explicit-any
const tagFromJson = (json: any): DafnyTag => {
  return TodoDomain.Tag.create_Tag(
    _dafny.Seq.UnicodeFromString(json.name)
  );
};

// deno-lint-ignore no-explicit-any
const tagToJson = (value: any): Tag => {
  return {
    name: dafnyStringToJs(value.dtor_name)
  };
};

// deno-lint-ignore no-explicit-any
const projectmodeFromJson = (json: any): DafnyProjectMode => {
  switch (json) {
    case 'Personal':
      return TodoDomain.ProjectMode.create_Personal();
    case 'Collaborative':
      return TodoDomain.ProjectMode.create_Collaborative();
    default:
      throw new Error(`Unknown ProjectMode: ${json}`);
  }
};

// deno-lint-ignore no-explicit-any
const projectmodeToJson = (value: any): ProjectMode => {
  if (value.is_Personal) {
    return 'Personal';
  } else if (value.is_Collaborative) {
    return 'Collaborative';
  }
  throw new Error('Unknown ProjectMode variant');
};

// deno-lint-ignore no-explicit-any
const modelFromJson = (json: any): DafnyModel => {
  let __listNames = _dafny.Map.Empty;
  for (const [k, v] of (Object.entries(json.listNames || {}) as [string, any][])) {
    const key = new BigNumber(k);
    const val = _dafny.Seq.UnicodeFromString(v);
    __listNames = __listNames.update(key, val);
  }
  let __tasks = _dafny.Map.Empty;
  for (const [k, v] of (Object.entries(json.tasks || {}) as [string, any][])) {
    const key = new BigNumber(k);
    const val = _dafny.Seq.of(...(v || []).map((x: any) => new BigNumber(x)));
    __tasks = __tasks.update(key, val);
  }
  let __taskData = _dafny.Map.Empty;
  for (const [k, v] of (Object.entries(json.taskData || {}) as [string, any][])) {
    const key = new BigNumber(k);
    const val = taskFromJson(v);
    __taskData = __taskData.update(key, val);
  }
  let __tags = _dafny.Map.Empty;
  for (const [k, v] of (Object.entries(json.tags || {}) as [string, any][])) {
    const key = new BigNumber(k);
    const val = tagFromJson(v);
    __tags = __tags.update(key, val);
  }
  return TodoDomain.Model.create_Model(
    projectmodeFromJson(json.mode),
    _dafny.Seq.UnicodeFromString(json.owner),
    _dafny.Set.fromElements(...(json.members || []).map((x: any) => _dafny.Seq.UnicodeFromString(x))),
    _dafny.Seq.of(...(json.lists || []).map((x: any) => new BigNumber(x))),
    __listNames,
    __tasks,
    __taskData,
    __tags,
    new BigNumber(json.nextListId),
    new BigNumber(json.nextTaskId),
    new BigNumber(json.nextTagId)
  );
};

// deno-lint-ignore no-explicit-any
const modelToJson = (value: any): Model => {
  const __listNamesJson: Record<string, any> = {};
  if (value.dtor_listNames && value.dtor_listNames.Keys) {
    for (const k of value.dtor_listNames.Keys.Elements) {
      const v = value.dtor_listNames.get(k);
      __listNamesJson[toNumber(k)] = dafnyStringToJs(v);
    }
  }
  const __tasksJson: Record<string, any> = {};
  if (value.dtor_tasks && value.dtor_tasks.Keys) {
    for (const k of value.dtor_tasks.Keys.Elements) {
      const v = value.dtor_tasks.get(k);
      __tasksJson[toNumber(k)] = seqToArray(v).map((x: any) => toNumber(x));
    }
  }
  const __taskDataJson: Record<string, any> = {};
  if (value.dtor_taskData && value.dtor_taskData.Keys) {
    for (const k of value.dtor_taskData.Keys.Elements) {
      const v = value.dtor_taskData.get(k);
      __taskDataJson[toNumber(k)] = taskToJson(v);
    }
  }
  const __tagsJson: Record<string, any> = {};
  if (value.dtor_tags && value.dtor_tags.Keys) {
    for (const k of value.dtor_tags.Keys.Elements) {
      const v = value.dtor_tags.get(k);
      __tagsJson[toNumber(k)] = tagToJson(v);
    }
  }
  return {
    mode: projectmodeToJson(value.dtor_mode),
    owner: dafnyStringToJs(value.dtor_owner),
    members: Array.from(value.dtor_members.Elements).map((x: any) => dafnyStringToJs(x)),
    lists: seqToArray(value.dtor_lists).map((x: any) => toNumber(x)),
    listNames: __listNamesJson,
    tasks: __tasksJson,
    taskData: __taskDataJson,
    tags: __tagsJson,
    nextListId: toNumber(value.dtor_nextListId),
    nextTaskId: toNumber(value.dtor_nextTaskId),
    nextTagId: toNumber(value.dtor_nextTagId)
  };
};

// deno-lint-ignore no-explicit-any
const errFromJson = (json: any): DafnyErr => {
  switch (json) {
    case 'MissingList':
      return TodoDomain.Err.create_MissingList();
    case 'MissingTask':
      return TodoDomain.Err.create_MissingTask();
    case 'MissingTag':
      return TodoDomain.Err.create_MissingTag();
    case 'MissingUser':
      return TodoDomain.Err.create_MissingUser();
    case 'DuplicateList':
      return TodoDomain.Err.create_DuplicateList();
    case 'DuplicateTask':
      return TodoDomain.Err.create_DuplicateTask();
    case 'DuplicateTag':
      return TodoDomain.Err.create_DuplicateTag();
    case 'BadAnchor':
      return TodoDomain.Err.create_BadAnchor();
    case 'NotAMember':
      return TodoDomain.Err.create_NotAMember();
    case 'PersonalProject':
      return TodoDomain.Err.create_PersonalProject();
    case 'AlreadyCollaborative':
      return TodoDomain.Err.create_AlreadyCollaborative();
    case 'CannotRemoveOwner':
      return TodoDomain.Err.create_CannotRemoveOwner();
    case 'TaskDeleted':
      return TodoDomain.Err.create_TaskDeleted();
    case 'InvalidDate':
      return TodoDomain.Err.create_InvalidDate();
    case 'Rejected':
      return TodoDomain.Err.create_Rejected();
    default:
      throw new Error(`Unknown Err: ${json}`);
  }
};

// deno-lint-ignore no-explicit-any
const errToJson = (value: any): Err => {
  if (value.is_MissingList) {
    return 'MissingList';
  } else if (value.is_MissingTask) {
    return 'MissingTask';
  } else if (value.is_MissingTag) {
    return 'MissingTag';
  } else if (value.is_MissingUser) {
    return 'MissingUser';
  } else if (value.is_DuplicateList) {
    return 'DuplicateList';
  } else if (value.is_DuplicateTask) {
    return 'DuplicateTask';
  } else if (value.is_DuplicateTag) {
    return 'DuplicateTag';
  } else if (value.is_BadAnchor) {
    return 'BadAnchor';
  } else if (value.is_NotAMember) {
    return 'NotAMember';
  } else if (value.is_PersonalProject) {
    return 'PersonalProject';
  } else if (value.is_AlreadyCollaborative) {
    return 'AlreadyCollaborative';
  } else if (value.is_CannotRemoveOwner) {
    return 'CannotRemoveOwner';
  } else if (value.is_TaskDeleted) {
    return 'TaskDeleted';
  } else if (value.is_InvalidDate) {
    return 'InvalidDate';
  } else if (value.is_Rejected) {
    return 'Rejected';
  }
  throw new Error('Unknown Err variant');
};

// deno-lint-ignore no-explicit-any
const placeFromJson = (json: any): DafnyPlace => {
  switch (json.type) {
    case 'AtEnd': {
      return TodoDomain.Place.create_AtEnd();
    }
    case 'Before': {
      return TodoDomain.Place.create_Before(
        new BigNumber(json.anchor)
      );
    }
    case 'After': {
      return TodoDomain.Place.create_After(
        new BigNumber(json.anchor)
      );
    }
    default:
      throw new Error(`Unknown Place type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const placeToJson = (value: any): Place => {
  if (value.is_AtEnd) {
    return { type: 'AtEnd' };
  } else if (value.is_Before) {
    return {
      type: 'Before',
      anchor: toNumber(value.dtor_anchor)
    };
  } else if (value.is_After) {
    return {
      type: 'After',
      anchor: toNumber(value.dtor_anchor)
    };
  }
  throw new Error('Unknown Place variant');
};

// deno-lint-ignore no-explicit-any
const listplaceFromJson = (json: any): DafnyListPlace => {
  switch (json.type) {
    case 'ListAtEnd': {
      return TodoDomain.ListPlace.create_ListAtEnd();
    }
    case 'ListBefore': {
      return TodoDomain.ListPlace.create_ListBefore(
        new BigNumber(json.anchor)
      );
    }
    case 'ListAfter': {
      return TodoDomain.ListPlace.create_ListAfter(
        new BigNumber(json.anchor)
      );
    }
    default:
      throw new Error(`Unknown ListPlace type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const listplaceToJson = (value: any): ListPlace => {
  if (value.is_ListAtEnd) {
    return { type: 'ListAtEnd' };
  } else if (value.is_ListBefore) {
    return {
      type: 'ListBefore',
      anchor: toNumber(value.dtor_anchor)
    };
  } else if (value.is_ListAfter) {
    return {
      type: 'ListAfter',
      anchor: toNumber(value.dtor_anchor)
    };
  }
  throw new Error('Unknown ListPlace variant');
};

// deno-lint-ignore no-explicit-any
const actionFromJson = (json: any): DafnyAction => {
  switch (json.type) {
    case 'NoOp': {
      return TodoDomain.Action.create_NoOp();
    }
    case 'AddList': {
      return TodoDomain.Action.create_AddList(
        _dafny.Seq.UnicodeFromString(json.name)
      );
    }
    case 'RenameList': {
      return TodoDomain.Action.create_RenameList(
        new BigNumber(json.listId),
        _dafny.Seq.UnicodeFromString(json.newName)
      );
    }
    case 'DeleteList': {
      return TodoDomain.Action.create_DeleteList(
        new BigNumber(json.listId)
      );
    }
    case 'MoveList': {
      return TodoDomain.Action.create_MoveList(
        new BigNumber(json.listId),
        listplaceFromJson(json.listPlace)
      );
    }
    case 'AddTask': {
      return TodoDomain.Action.create_AddTask(
        new BigNumber(json.listId),
        _dafny.Seq.UnicodeFromString(json.title)
      );
    }
    case 'EditTask': {
      return TodoDomain.Action.create_EditTask(
        new BigNumber(json.taskId),
        _dafny.Seq.UnicodeFromString(json.title),
        _dafny.Seq.UnicodeFromString(json.notes)
      );
    }
    case 'DeleteTask': {
      return TodoDomain.Action.create_DeleteTask(
        new BigNumber(json.taskId),
        _dafny.Seq.UnicodeFromString(json.userId)
      );
    }
    case 'RestoreTask': {
      return TodoDomain.Action.create_RestoreTask(
        new BigNumber(json.taskId)
      );
    }
    case 'MoveTask': {
      return TodoDomain.Action.create_MoveTask(
        new BigNumber(json.taskId),
        new BigNumber(json.toList),
        placeFromJson(json.taskPlace)
      );
    }
    case 'CompleteTask': {
      return TodoDomain.Action.create_CompleteTask(
        new BigNumber(json.taskId)
      );
    }
    case 'UncompleteTask': {
      return TodoDomain.Action.create_UncompleteTask(
        new BigNumber(json.taskId)
      );
    }
    case 'StarTask': {
      return TodoDomain.Action.create_StarTask(
        new BigNumber(json.taskId)
      );
    }
    case 'UnstarTask': {
      return TodoDomain.Action.create_UnstarTask(
        new BigNumber(json.taskId)
      );
    }
    case 'SetDueDate': {
      return TodoDomain.Action.create_SetDueDate(
        new BigNumber(json.taskId),
        optionFromJson(json.dueDate, dateFromJson)
      );
    }
    case 'AssignTask': {
      return TodoDomain.Action.create_AssignTask(
        new BigNumber(json.taskId),
        _dafny.Seq.UnicodeFromString(json.userId)
      );
    }
    case 'UnassignTask': {
      return TodoDomain.Action.create_UnassignTask(
        new BigNumber(json.taskId),
        _dafny.Seq.UnicodeFromString(json.userId)
      );
    }
    case 'AddTagToTask': {
      return TodoDomain.Action.create_AddTagToTask(
        new BigNumber(json.taskId),
        new BigNumber(json.tagId)
      );
    }
    case 'RemoveTagFromTask': {
      return TodoDomain.Action.create_RemoveTagFromTask(
        new BigNumber(json.taskId),
        new BigNumber(json.tagId)
      );
    }
    case 'CreateTag': {
      return TodoDomain.Action.create_CreateTag(
        _dafny.Seq.UnicodeFromString(json.name)
      );
    }
    case 'RenameTag': {
      return TodoDomain.Action.create_RenameTag(
        new BigNumber(json.tagId),
        _dafny.Seq.UnicodeFromString(json.newName)
      );
    }
    case 'DeleteTag': {
      return TodoDomain.Action.create_DeleteTag(
        new BigNumber(json.tagId)
      );
    }
    case 'MakeCollaborative': {
      return TodoDomain.Action.create_MakeCollaborative();
    }
    case 'AddMember': {
      return TodoDomain.Action.create_AddMember(
        _dafny.Seq.UnicodeFromString(json.userId)
      );
    }
    case 'RemoveMember': {
      return TodoDomain.Action.create_RemoveMember(
        _dafny.Seq.UnicodeFromString(json.userId)
      );
    }
    default:
      throw new Error(`Unknown Action type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const actionToJson = (value: any): Action => {
  if (value.is_NoOp) {
    return { type: 'NoOp' };
  } else if (value.is_AddList) {
    return {
      type: 'AddList',
      name: dafnyStringToJs(value.dtor_name)
    };
  } else if (value.is_RenameList) {
    return {
      type: 'RenameList',
      listId: toNumber(value.dtor_listId),
      newName: dafnyStringToJs(value.dtor_newName)
    };
  } else if (value.is_DeleteList) {
    return {
      type: 'DeleteList',
      listId: toNumber(value.dtor_listId)
    };
  } else if (value.is_MoveList) {
    return {
      type: 'MoveList',
      listId: toNumber(value.dtor_listId),
      listPlace: listplaceToJson(value.dtor_listPlace)
    };
  } else if (value.is_AddTask) {
    return {
      type: 'AddTask',
      listId: toNumber(value.dtor_listId),
      title: dafnyStringToJs(value.dtor_title)
    };
  } else if (value.is_EditTask) {
    return {
      type: 'EditTask',
      taskId: toNumber(value.dtor_taskId),
      title: dafnyStringToJs(value.dtor_title),
      notes: dafnyStringToJs(value.dtor_notes)
    };
  } else if (value.is_DeleteTask) {
    return {
      type: 'DeleteTask',
      taskId: toNumber(value.dtor_taskId),
      userId: dafnyStringToJs(value.dtor_userId)
    };
  } else if (value.is_RestoreTask) {
    return {
      type: 'RestoreTask',
      taskId: toNumber(value.dtor_taskId)
    };
  } else if (value.is_MoveTask) {
    return {
      type: 'MoveTask',
      taskId: toNumber(value.dtor_taskId),
      toList: toNumber(value.dtor_toList),
      taskPlace: placeToJson(value.dtor_taskPlace)
    };
  } else if (value.is_CompleteTask) {
    return {
      type: 'CompleteTask',
      taskId: toNumber(value.dtor_taskId)
    };
  } else if (value.is_UncompleteTask) {
    return {
      type: 'UncompleteTask',
      taskId: toNumber(value.dtor_taskId)
    };
  } else if (value.is_StarTask) {
    return {
      type: 'StarTask',
      taskId: toNumber(value.dtor_taskId)
    };
  } else if (value.is_UnstarTask) {
    return {
      type: 'UnstarTask',
      taskId: toNumber(value.dtor_taskId)
    };
  } else if (value.is_SetDueDate) {
    return {
      type: 'SetDueDate',
      taskId: toNumber(value.dtor_taskId),
      dueDate: optionToJson(value.dtor_dueDate, dateToJson)
    };
  } else if (value.is_AssignTask) {
    return {
      type: 'AssignTask',
      taskId: toNumber(value.dtor_taskId),
      userId: dafnyStringToJs(value.dtor_userId)
    };
  } else if (value.is_UnassignTask) {
    return {
      type: 'UnassignTask',
      taskId: toNumber(value.dtor_taskId),
      userId: dafnyStringToJs(value.dtor_userId)
    };
  } else if (value.is_AddTagToTask) {
    return {
      type: 'AddTagToTask',
      taskId: toNumber(value.dtor_taskId),
      tagId: toNumber(value.dtor_tagId)
    };
  } else if (value.is_RemoveTagFromTask) {
    return {
      type: 'RemoveTagFromTask',
      taskId: toNumber(value.dtor_taskId),
      tagId: toNumber(value.dtor_tagId)
    };
  } else if (value.is_CreateTag) {
    return {
      type: 'CreateTag',
      name: dafnyStringToJs(value.dtor_name)
    };
  } else if (value.is_RenameTag) {
    return {
      type: 'RenameTag',
      tagId: toNumber(value.dtor_tagId),
      newName: dafnyStringToJs(value.dtor_newName)
    };
  } else if (value.is_DeleteTag) {
    return {
      type: 'DeleteTag',
      tagId: toNumber(value.dtor_tagId)
    };
  } else if (value.is_MakeCollaborative) {
    return { type: 'MakeCollaborative' };
  } else if (value.is_AddMember) {
    return {
      type: 'AddMember',
      userId: dafnyStringToJs(value.dtor_userId)
    };
  } else if (value.is_RemoveMember) {
    return {
      type: 'RemoveMember',
      userId: dafnyStringToJs(value.dtor_userId)
    };
  }
  throw new Error('Unknown Action variant');
};

// deno-lint-ignore no-explicit-any
const viewmodeFromJson = (json: any): DafnyViewMode => {
  switch (json) {
    case 'SingleProject':
      return TodoDomain.ViewMode.create_SingleProject();
    case 'AllProjects':
      return TodoDomain.ViewMode.create_AllProjects();
    default:
      throw new Error(`Unknown ViewMode: ${json}`);
  }
};

// deno-lint-ignore no-explicit-any
const viewmodeToJson = (value: any): ViewMode => {
  if (value.is_SingleProject) {
    return 'SingleProject';
  } else if (value.is_AllProjects) {
    return 'AllProjects';
  }
  throw new Error('Unknown ViewMode variant');
};

// deno-lint-ignore no-explicit-any
const smartlisttypeFromJson = (json: any): DafnySmartListType => {
  switch (json) {
    case 'Priority':
      return TodoDomain.SmartListType.create_Priority();
    case 'Logbook':
      return TodoDomain.SmartListType.create_Logbook();
    default:
      throw new Error(`Unknown SmartListType: ${json}`);
  }
};

// deno-lint-ignore no-explicit-any
const smartlisttypeToJson = (value: any): SmartListType => {
  if (value.is_Priority) {
    return 'Priority';
  } else if (value.is_Logbook) {
    return 'Logbook';
  }
  throw new Error('Unknown SmartListType variant');
};

// deno-lint-ignore no-explicit-any
const resultFromJson = <T, E>(json: any, T_fromJson: (x: any) => T, E_fromJson: (x: any) => E): DafnyResult<T, E> => {
  switch (json.type) {
    case 'Ok': {
      return TodoDomain.Result.create_Ok(
        T_fromJson(json.value)
      );
    }
    case 'Err': {
      return TodoDomain.Result.create_Err(
        E_fromJson(json.error)
      );
    }
    default:
      throw new Error(`Unknown Result type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const resultToJson = <T, E>(value: any, T_toJson: (x: any) => any, E_toJson: (x: any) => any): Result<T, E> => {
  if (value.is_Ok) {
    return {
      type: 'Ok',
      value: T_toJson(value.dtor_value)
    };
  } else if (value.is_Err) {
    return {
      type: 'Err',
      error: E_toJson(value.dtor_error)
    };
  }
  throw new Error('Unknown Result variant');
};

// deno-lint-ignore no-explicit-any
const multiactionFromJson = (json: any): DafnyMultiAction => {
  switch (json.type) {
    case 'Single': {
      return TodoMultiProjectDomain.MultiAction.create_Single(
        _dafny.Seq.UnicodeFromString(json.project),
        actionFromJson(json.action)
      );
    }
    case 'MoveTaskTo': {
      return TodoMultiProjectDomain.MultiAction.create_MoveTaskTo(
        _dafny.Seq.UnicodeFromString(json.srcProject),
        _dafny.Seq.UnicodeFromString(json.dstProject),
        new BigNumber(json.taskId),
        new BigNumber(json.dstList),
        placeFromJson(json.anchor)
      );
    }
    case 'CopyTaskTo': {
      return TodoMultiProjectDomain.MultiAction.create_CopyTaskTo(
        _dafny.Seq.UnicodeFromString(json.srcProject),
        _dafny.Seq.UnicodeFromString(json.dstProject),
        new BigNumber(json.taskId),
        new BigNumber(json.dstList)
      );
    }
    case 'MoveListTo': {
      return TodoMultiProjectDomain.MultiAction.create_MoveListTo(
        _dafny.Seq.UnicodeFromString(json.srcProject),
        _dafny.Seq.UnicodeFromString(json.dstProject),
        new BigNumber(json.listId)
      );
    }
    default:
      throw new Error(`Unknown MultiAction type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const multiactionToJson = (value: any): MultiAction => {
  if (value.is_Single) {
    return {
      type: 'Single',
      project: dafnyStringToJs(value.dtor_project),
      action: actionToJson(value.dtor_action)
    };
  } else if (value.is_MoveTaskTo) {
    return {
      type: 'MoveTaskTo',
      srcProject: dafnyStringToJs(value.dtor_srcProject),
      dstProject: dafnyStringToJs(value.dtor_dstProject),
      taskId: toNumber(value.dtor_taskId),
      dstList: toNumber(value.dtor_dstList),
      anchor: placeToJson(value.dtor_anchor)
    };
  } else if (value.is_CopyTaskTo) {
    return {
      type: 'CopyTaskTo',
      srcProject: dafnyStringToJs(value.dtor_srcProject),
      dstProject: dafnyStringToJs(value.dtor_dstProject),
      taskId: toNumber(value.dtor_taskId),
      dstList: toNumber(value.dtor_dstList)
    };
  } else if (value.is_MoveListTo) {
    return {
      type: 'MoveListTo',
      srcProject: dafnyStringToJs(value.dtor_srcProject),
      dstProject: dafnyStringToJs(value.dtor_dstProject),
      listId: toNumber(value.dtor_listId)
    };
  }
  throw new Error('Unknown MultiAction variant');
};

// deno-lint-ignore no-explicit-any
const multimodelFromJson = (json: any): DafnyMultiModel => {
  let __projects = _dafny.Map.Empty;
  for (const [k, v] of (Object.entries(json.projects || {}) as [string, any][])) {
    const key = _dafny.Seq.UnicodeFromString(k);
    const val = modelFromJson(v);
    __projects = __projects.update(key, val);
  }
  return TodoMultiProjectDomain.MultiModel.create_MultiModel(
    __projects
  );
};

// deno-lint-ignore no-explicit-any
const multimodelToJson = (value: any): MultiModel => {
  const __projectsJson: Record<string, any> = {};
  if (value.dtor_projects && value.dtor_projects.Keys) {
    for (const k of value.dtor_projects.Keys.Elements) {
      const v = value.dtor_projects.get(k);
      __projectsJson[dafnyStringToJs(k)] = modelToJson(v);
    }
  }
  return {
    projects: __projectsJson
  };
};

// deno-lint-ignore no-explicit-any
const multierrFromJson = (json: any): DafnyMultiErr => {
  switch (json.type) {
    case 'MissingProject': {
      return TodoMultiProjectDomain.MultiErr.create_MissingProject(
        _dafny.Seq.UnicodeFromString(json.projectId)
      );
    }
    case 'SingleProjectError': {
      return TodoMultiProjectDomain.MultiErr.create_SingleProjectError(
        _dafny.Seq.UnicodeFromString(json.projectId),
        errFromJson(json.err)
      );
    }
    case 'CrossProjectError': {
      return TodoMultiProjectDomain.MultiErr.create_CrossProjectError(
        _dafny.Seq.UnicodeFromString(json.message)
      );
    }
    default:
      throw new Error(`Unknown MultiErr type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const multierrToJson = (value: any): MultiErr => {
  if (value.is_MissingProject) {
    return {
      type: 'MissingProject',
      projectId: dafnyStringToJs(value.dtor_projectId)
    };
  } else if (value.is_SingleProjectError) {
    return {
      type: 'SingleProjectError',
      projectId: dafnyStringToJs(value.dtor_projectId),
      err: errToJson(value.dtor_err)
    };
  } else if (value.is_CrossProjectError) {
    return {
      type: 'CrossProjectError',
      message: dafnyStringToJs(value.dtor_message)
    };
  }
  throw new Error('Unknown MultiErr variant');
};

// deno-lint-ignore no-explicit-any
const multiclientstateFromJson = (json: any): DafnyMultiClientState => {
  let __baseVersions = _dafny.Map.Empty;
  for (const [k, v] of (Object.entries(json.baseVersions || {}) as [string, any][])) {
    const key = _dafny.Seq.UnicodeFromString(k);
    const val = new BigNumber(v);
    __baseVersions = __baseVersions.update(key, val);
  }
  return TodoMultiProjectEffectStateMachine.MultiClientState.create_MultiClientState(
    __baseVersions,
    multimodelFromJson(json.present),
    _dafny.Seq.of(...(json.pending || []).map((x: any) => multiactionFromJson(x)))
  );
};

// deno-lint-ignore no-explicit-any
const multiclientstateToJson = (value: any): MultiClientState => {
  const __baseVersionsJson: Record<string, any> = {};
  if (value.dtor_baseVersions && value.dtor_baseVersions.Keys) {
    for (const k of value.dtor_baseVersions.Keys.Elements) {
      const v = value.dtor_baseVersions.get(k);
      __baseVersionsJson[dafnyStringToJs(k)] = toNumber(v);
    }
  }
  return {
    baseVersions: __baseVersionsJson,
    present: multimodelToJson(value.dtor_present),
    pending: seqToArray(value.dtor_pending).map((x: any) => multiactionToJson(x))
  };
};

// deno-lint-ignore no-explicit-any
const networkstatusFromJson = (json: any): DafnyNetworkStatus => {
  switch (json) {
    case 'Online':
      return TodoMultiProjectEffectStateMachine.NetworkStatus.create_Online();
    case 'Offline':
      return TodoMultiProjectEffectStateMachine.NetworkStatus.create_Offline();
    default:
      throw new Error(`Unknown NetworkStatus: ${json}`);
  }
};

// deno-lint-ignore no-explicit-any
const networkstatusToJson = (value: any): NetworkStatus => {
  if (value.is_Online) {
    return 'Online';
  } else if (value.is_Offline) {
    return 'Offline';
  }
  throw new Error('Unknown NetworkStatus variant');
};

// deno-lint-ignore no-explicit-any
const effectmodeFromJson = (json: any): DafnyEffectMode => {
  switch (json.type) {
    case 'Idle': {
      return TodoMultiProjectEffectStateMachine.EffectMode.create_Idle();
    }
    case 'Dispatching': {
      return TodoMultiProjectEffectStateMachine.EffectMode.create_Dispatching(
        new BigNumber(json.retries)
      );
    }
    default:
      throw new Error(`Unknown EffectMode type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const effectmodeToJson = (value: any): EffectMode => {
  if (value.is_Idle) {
    return { type: 'Idle' };
  } else if (value.is_Dispatching) {
    return {
      type: 'Dispatching',
      retries: toNumber(value.dtor_retries)
    };
  }
  throw new Error('Unknown EffectMode variant');
};

// deno-lint-ignore no-explicit-any
const effectstateFromJson = (json: any): DafnyEffectState => {
  return TodoMultiProjectEffectStateMachine.EffectState.create_EffectState(
    networkstatusFromJson(json.network),
    effectmodeFromJson(json.mode),
    multiclientstateFromJson(json.client)
  );
};

// deno-lint-ignore no-explicit-any
const effectstateToJson = (value: any): EffectState => {
  return {
    network: networkstatusToJson(value.dtor_network),
    mode: effectmodeToJson(value.dtor_mode),
    client: multiclientstateToJson(value.dtor_client)
  };
};

// deno-lint-ignore no-explicit-any
const eventFromJson = (json: any): DafnyEvent => {
  switch (json.type) {
    case 'UserAction': {
      return TodoMultiProjectEffectStateMachine.Event.create_UserAction(
        multiactionFromJson(json.action)
      );
    }
    case 'DispatchAccepted': {
      let __newVersions = _dafny.Map.Empty;
      for (const [k, v] of (Object.entries(json.newVersions || {}) as [string, any][])) {
        const key = _dafny.Seq.UnicodeFromString(k);
        const val = new BigNumber(v);
        __newVersions = __newVersions.update(key, val);
      }
      let __newModels = _dafny.Map.Empty;
      for (const [k, v] of (Object.entries(json.newModels || {}) as [string, any][])) {
        const key = _dafny.Seq.UnicodeFromString(k);
        const val = modelFromJson(v);
        __newModels = __newModels.update(key, val);
      }
      return TodoMultiProjectEffectStateMachine.Event.create_DispatchAccepted(
        __newVersions,
        __newModels
      );
    }
    case 'DispatchConflict': {
      let __freshVersions = _dafny.Map.Empty;
      for (const [k, v] of (Object.entries(json.freshVersions || {}) as [string, any][])) {
        const key = _dafny.Seq.UnicodeFromString(k);
        const val = new BigNumber(v);
        __freshVersions = __freshVersions.update(key, val);
      }
      let __freshModels = _dafny.Map.Empty;
      for (const [k, v] of (Object.entries(json.freshModels || {}) as [string, any][])) {
        const key = _dafny.Seq.UnicodeFromString(k);
        const val = modelFromJson(v);
        __freshModels = __freshModels.update(key, val);
      }
      return TodoMultiProjectEffectStateMachine.Event.create_DispatchConflict(
        __freshVersions,
        __freshModels
      );
    }
    case 'DispatchRejected': {
      let __freshVersions = _dafny.Map.Empty;
      for (const [k, v] of (Object.entries(json.freshVersions || {}) as [string, any][])) {
        const key = _dafny.Seq.UnicodeFromString(k);
        const val = new BigNumber(v);
        __freshVersions = __freshVersions.update(key, val);
      }
      let __freshModels = _dafny.Map.Empty;
      for (const [k, v] of (Object.entries(json.freshModels || {}) as [string, any][])) {
        const key = _dafny.Seq.UnicodeFromString(k);
        const val = modelFromJson(v);
        __freshModels = __freshModels.update(key, val);
      }
      return TodoMultiProjectEffectStateMachine.Event.create_DispatchRejected(
        __freshVersions,
        __freshModels
      );
    }
    case 'RealtimeUpdate': {
      return TodoMultiProjectEffectStateMachine.Event.create_RealtimeUpdate(
        _dafny.Seq.UnicodeFromString(json.projectId),
        new BigNumber(json.version),
        modelFromJson(json.model)
      );
    }
    case 'NetworkError': {
      return TodoMultiProjectEffectStateMachine.Event.create_NetworkError();
    }
    case 'NetworkRestored': {
      return TodoMultiProjectEffectStateMachine.Event.create_NetworkRestored();
    }
    case 'ManualGoOffline': {
      return TodoMultiProjectEffectStateMachine.Event.create_ManualGoOffline();
    }
    case 'ManualGoOnline': {
      return TodoMultiProjectEffectStateMachine.Event.create_ManualGoOnline();
    }
    case 'Tick': {
      return TodoMultiProjectEffectStateMachine.Event.create_Tick();
    }
    default:
      throw new Error(`Unknown Event type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const eventToJson = (value: any): Event => {
  if (value.is_UserAction) {
    return {
      type: 'UserAction',
      action: multiactionToJson(value.dtor_action)
    };
  } else if (value.is_DispatchAccepted) {
    const __newVersionsJson: Record<string, any> = {};
    if (value.dtor_newVersions && value.dtor_newVersions.Keys) {
      for (const k of value.dtor_newVersions.Keys.Elements) {
        const v = value.dtor_newVersions.get(k);
        __newVersionsJson[dafnyStringToJs(k)] = toNumber(v);
      }
    }
    const __newModelsJson: Record<string, any> = {};
    if (value.dtor_newModels && value.dtor_newModels.Keys) {
      for (const k of value.dtor_newModels.Keys.Elements) {
        const v = value.dtor_newModels.get(k);
        __newModelsJson[dafnyStringToJs(k)] = modelToJson(v);
      }
    }
    return {
      type: 'DispatchAccepted',
      newVersions: __newVersionsJson,
      newModels: __newModelsJson
    };
  } else if (value.is_DispatchConflict) {
    const __freshVersionsJson: Record<string, any> = {};
    if (value.dtor_freshVersions && value.dtor_freshVersions.Keys) {
      for (const k of value.dtor_freshVersions.Keys.Elements) {
        const v = value.dtor_freshVersions.get(k);
        __freshVersionsJson[dafnyStringToJs(k)] = toNumber(v);
      }
    }
    const __freshModelsJson: Record<string, any> = {};
    if (value.dtor_freshModels && value.dtor_freshModels.Keys) {
      for (const k of value.dtor_freshModels.Keys.Elements) {
        const v = value.dtor_freshModels.get(k);
        __freshModelsJson[dafnyStringToJs(k)] = modelToJson(v);
      }
    }
    return {
      type: 'DispatchConflict',
      freshVersions: __freshVersionsJson,
      freshModels: __freshModelsJson
    };
  } else if (value.is_DispatchRejected) {
    const __freshVersionsJson: Record<string, any> = {};
    if (value.dtor_freshVersions && value.dtor_freshVersions.Keys) {
      for (const k of value.dtor_freshVersions.Keys.Elements) {
        const v = value.dtor_freshVersions.get(k);
        __freshVersionsJson[dafnyStringToJs(k)] = toNumber(v);
      }
    }
    const __freshModelsJson: Record<string, any> = {};
    if (value.dtor_freshModels && value.dtor_freshModels.Keys) {
      for (const k of value.dtor_freshModels.Keys.Elements) {
        const v = value.dtor_freshModels.get(k);
        __freshModelsJson[dafnyStringToJs(k)] = modelToJson(v);
      }
    }
    return {
      type: 'DispatchRejected',
      freshVersions: __freshVersionsJson,
      freshModels: __freshModelsJson
    };
  } else if (value.is_RealtimeUpdate) {
    return {
      type: 'RealtimeUpdate',
      projectId: dafnyStringToJs(value.dtor_projectId),
      version: toNumber(value.dtor_version),
      model: modelToJson(value.dtor_model)
    };
  } else if (value.is_NetworkError) {
    return { type: 'NetworkError' };
  } else if (value.is_NetworkRestored) {
    return { type: 'NetworkRestored' };
  } else if (value.is_ManualGoOffline) {
    return { type: 'ManualGoOffline' };
  } else if (value.is_ManualGoOnline) {
    return { type: 'ManualGoOnline' };
  } else if (value.is_Tick) {
    return { type: 'Tick' };
  }
  throw new Error('Unknown Event variant');
};

// deno-lint-ignore no-explicit-any
const commandFromJson = (json: any): DafnyCommand => {
  switch (json.type) {
    case 'NoOp': {
      return TodoMultiProjectEffectStateMachine.Command.create_NoOp();
    }
    case 'SendDispatch': {
      let __baseVersions = _dafny.Map.Empty;
      for (const [k, v] of (Object.entries(json.baseVersions || {}) as [string, any][])) {
        const key = _dafny.Seq.UnicodeFromString(k);
        const val = new BigNumber(v);
        __baseVersions = __baseVersions.update(key, val);
      }
      return TodoMultiProjectEffectStateMachine.Command.create_SendDispatch(
        _dafny.Set.fromElements(...(json.touchedProjects || []).map((x: any) => _dafny.Seq.UnicodeFromString(x))),
        __baseVersions,
        multiactionFromJson(json.action)
      );
    }
    case 'FetchFreshState': {
      return TodoMultiProjectEffectStateMachine.Command.create_FetchFreshState(
        _dafny.Set.fromElements(...(json.projects || []).map((x: any) => _dafny.Seq.UnicodeFromString(x)))
      );
    }
    default:
      throw new Error(`Unknown Command type: ${json.type}`);
  }
};

// deno-lint-ignore no-explicit-any
const commandToJson = (value: any): Command => {
  if (value.is_NoOp) {
    return { type: 'NoOp' };
  } else if (value.is_SendDispatch) {
    const __baseVersionsJson: Record<string, any> = {};
    if (value.dtor_baseVersions && value.dtor_baseVersions.Keys) {
      for (const k of value.dtor_baseVersions.Keys.Elements) {
        const v = value.dtor_baseVersions.get(k);
        __baseVersionsJson[dafnyStringToJs(k)] = toNumber(v);
      }
    }
    return {
      type: 'SendDispatch',
      touchedProjects: Array.from(value.dtor_touchedProjects.Elements).map((x: any) => dafnyStringToJs(x)),
      baseVersions: __baseVersionsJson,
      action: multiactionToJson(value.dtor_action)
    };
  } else if (value.is_FetchFreshState) {
    return {
      type: 'FetchFreshState',
      projects: Array.from(value.dtor_projects.Elements).map((x: any) => dafnyStringToJs(x))
    };
  }
  throw new Error('Unknown Command variant');
};

// ============================================================================
// Null-Option Preprocessing (for DB compatibility)
// ============================================================================

// Convert null to { type: 'None' } for Option fields
// deno-lint-ignore no-explicit-any
const fixOption = (val: any): any => {
  if (val === null || val === undefined) return { type: 'None' };
  if (val && val.type) return val; // Already in correct format
  return { type: 'Some', value: val };
};

// deno-lint-ignore no-explicit-any
const preprocessTaskJson = (json: any): any => {
  if (!json) return json;
  return {
    ...json,
    dueDate: fixOption(json.dueDate),
    deletedBy: fixOption(json.deletedBy),
    deletedFromList: fixOption(json.deletedFromList),
  };
};

// Wrapped taskFromJson with preprocessing
const _taskFromJsonOriginal = taskFromJson;
// deno-lint-ignore no-explicit-any
const taskFromJsonPreprocessed = (json: any): any => _taskFromJsonOriginal(preprocessTaskJson(json));

// deno-lint-ignore no-explicit-any
const preprocessActionJson = (json: any): any => {
  if (!json) return json;
  switch (json.type) {
    case 'SetDueDate':
      return {
        ...json,
        dueDate: fixOption(json.dueDate),
      };
    default:
      return json;
  }
};

// Wrapped actionFromJson with preprocessing
const _actionFromJsonOriginal = actionFromJson;
// deno-lint-ignore no-explicit-any
const actionFromJsonPreprocessed = (json: any): any => _actionFromJsonOriginal(preprocessActionJson(json));


// ============================================================================
// API Wrapper
// ============================================================================

interface AppInternal { _dafny: unknown; TodoDomain: unknown; TodoMultiProjectDomain: unknown; TodoMultiProjectEffectStateMachine: unknown; TodoMultiProjectEffectAppCore: unknown; }

const App = {
  // Option constructors
  None: () => TodoDomain.Option.create_None(),
  Some: (value: unknown) => TodoDomain.Option.create_Some(value),

  // Date constructors
  Date: (year: number, month: number, day: number) => TodoDomain.Date.create_Date(new BigNumber(year), new BigNumber(month), new BigNumber(day)),

  // Task constructors
  Task: (title: string, notes: string, completed: boolean, starred: boolean, dueDate: Option<Date>, assignees: string[], tags: number[], deleted: boolean, deletedBy: Option<string>, deletedFromList: Option<number>) => TodoDomain.Task.create_Task(_dafny.Seq.UnicodeFromString(title), _dafny.Seq.UnicodeFromString(notes), completed, starred, optionFromJson(dueDate, dateFromJson), _dafny.Set.fromElements(...(assignees || []).map((x: any) => _dafny.Seq.UnicodeFromString(x))), _dafny.Set.fromElements(...(tags || []).map((x: any) => new BigNumber(x))), deleted, optionFromJson(deletedBy, (x: any) => _dafny.Seq.UnicodeFromString(x)), optionFromJson(deletedFromList, (x: any) => new BigNumber(x))),

  // Tag constructors
  Tag: (name: string) => TodoDomain.Tag.create_Tag(_dafny.Seq.UnicodeFromString(name)),

  // ProjectMode constructors
  Personal: () => TodoDomain.ProjectMode.create_Personal(),
  Collaborative: () => TodoDomain.ProjectMode.create_Collaborative(),

  // Err constructors
  MissingList: () => TodoDomain.Err.create_MissingList(),
  MissingTask: () => TodoDomain.Err.create_MissingTask(),
  MissingTag: () => TodoDomain.Err.create_MissingTag(),
  MissingUser: () => TodoDomain.Err.create_MissingUser(),
  DuplicateList: () => TodoDomain.Err.create_DuplicateList(),
  DuplicateTask: () => TodoDomain.Err.create_DuplicateTask(),
  DuplicateTag: () => TodoDomain.Err.create_DuplicateTag(),
  BadAnchor: () => TodoDomain.Err.create_BadAnchor(),
  NotAMember: () => TodoDomain.Err.create_NotAMember(),
  PersonalProject: () => TodoDomain.Err.create_PersonalProject(),
  AlreadyCollaborative: () => TodoDomain.Err.create_AlreadyCollaborative(),
  CannotRemoveOwner: () => TodoDomain.Err.create_CannotRemoveOwner(),
  TaskDeleted: () => TodoDomain.Err.create_TaskDeleted(),
  InvalidDate: () => TodoDomain.Err.create_InvalidDate(),
  Rejected: () => TodoDomain.Err.create_Rejected(),

  // Place constructors
  AtEnd: () => TodoDomain.Place.create_AtEnd(),
  Before: (anchor: number) => TodoDomain.Place.create_Before(new BigNumber(anchor)),
  After: (anchor: number) => TodoDomain.Place.create_After(new BigNumber(anchor)),

  // ListPlace constructors
  ListAtEnd: () => TodoDomain.ListPlace.create_ListAtEnd(),
  ListBefore: (anchor: number) => TodoDomain.ListPlace.create_ListBefore(new BigNumber(anchor)),
  ListAfter: (anchor: number) => TodoDomain.ListPlace.create_ListAfter(new BigNumber(anchor)),

  // ViewMode constructors
  SingleProject: () => TodoDomain.ViewMode.create_SingleProject(),
  AllProjects: () => TodoDomain.ViewMode.create_AllProjects(),

  // SmartListType constructors
  Priority: () => TodoDomain.SmartListType.create_Priority(),
  Logbook: () => TodoDomain.SmartListType.create_Logbook(),

  // Result constructors
  Ok: (value: unknown) => TodoDomain.Result.create_Ok(value),
  Err: (error: unknown) => TodoDomain.Result.create_Err(error),

  // Action constructors
  NoOp: () => TodoDomain.Action.create_NoOp(),
  AddList: (name: string) => TodoDomain.Action.create_AddList(_dafny.Seq.UnicodeFromString(name)),
  RenameList: (listId: number, newName: string) => TodoDomain.Action.create_RenameList(new BigNumber(listId), _dafny.Seq.UnicodeFromString(newName)),
  DeleteList: (listId: number) => TodoDomain.Action.create_DeleteList(new BigNumber(listId)),
  MoveList: (listId: number, listPlace: DafnyListPlace) => TodoDomain.Action.create_MoveList(new BigNumber(listId), listPlace),
  AddTask: (listId: number, title: string) => TodoDomain.Action.create_AddTask(new BigNumber(listId), _dafny.Seq.UnicodeFromString(title)),
  EditTask: (taskId: number, title: string, notes: string) => TodoDomain.Action.create_EditTask(new BigNumber(taskId), _dafny.Seq.UnicodeFromString(title), _dafny.Seq.UnicodeFromString(notes)),
  DeleteTask: (taskId: number, userId: string) => TodoDomain.Action.create_DeleteTask(new BigNumber(taskId), _dafny.Seq.UnicodeFromString(userId)),
  RestoreTask: (taskId: number) => TodoDomain.Action.create_RestoreTask(new BigNumber(taskId)),
  MoveTask: (taskId: number, toList: number, taskPlace: DafnyPlace) => TodoDomain.Action.create_MoveTask(new BigNumber(taskId), new BigNumber(toList), taskPlace),
  CompleteTask: (taskId: number) => TodoDomain.Action.create_CompleteTask(new BigNumber(taskId)),
  UncompleteTask: (taskId: number) => TodoDomain.Action.create_UncompleteTask(new BigNumber(taskId)),
  StarTask: (taskId: number) => TodoDomain.Action.create_StarTask(new BigNumber(taskId)),
  UnstarTask: (taskId: number) => TodoDomain.Action.create_UnstarTask(new BigNumber(taskId)),
  SetDueDate: (taskId: number, dueDate: DafnyOption<DafnyDate>) => TodoDomain.Action.create_SetDueDate(new BigNumber(taskId), dueDate),
  AssignTask: (taskId: number, userId: string) => TodoDomain.Action.create_AssignTask(new BigNumber(taskId), _dafny.Seq.UnicodeFromString(userId)),
  UnassignTask: (taskId: number, userId: string) => TodoDomain.Action.create_UnassignTask(new BigNumber(taskId), _dafny.Seq.UnicodeFromString(userId)),
  AddTagToTask: (taskId: number, tagId: number) => TodoDomain.Action.create_AddTagToTask(new BigNumber(taskId), new BigNumber(tagId)),
  RemoveTagFromTask: (taskId: number, tagId: number) => TodoDomain.Action.create_RemoveTagFromTask(new BigNumber(taskId), new BigNumber(tagId)),
  CreateTag: (name: string) => TodoDomain.Action.create_CreateTag(_dafny.Seq.UnicodeFromString(name)),
  RenameTag: (tagId: number, newName: string) => TodoDomain.Action.create_RenameTag(new BigNumber(tagId), _dafny.Seq.UnicodeFromString(newName)),
  DeleteTag: (tagId: number) => TodoDomain.Action.create_DeleteTag(new BigNumber(tagId)),
  MakeCollaborative: () => TodoDomain.Action.create_MakeCollaborative(),
  AddMember: (userId: string) => TodoDomain.Action.create_AddMember(_dafny.Seq.UnicodeFromString(userId)),
  RemoveMember: (userId: string) => TodoDomain.Action.create_RemoveMember(_dafny.Seq.UnicodeFromString(userId)),

  // Model accessors
  GetMode: (m: DafnyModel) => projectmodeToJson(m.dtor_mode),
  GetOwner: (m: DafnyModel) => dafnyStringToJs(m.dtor_owner),
  GetMembers: (m: DafnyModel) => Array.from(m.dtor_members.Elements).map((x: any) => dafnyStringToJs(x)),
  GetLists: (m: DafnyModel) => seqToArray(m.dtor_lists).map((x: any) => toNumber(x)),
  GetListNames: (m: DafnyModel, key: number) => {
    const dafnyKey = new BigNumber(key);
    if (m.dtor_listNames.contains(dafnyKey)) {
      const val = m.dtor_listNames.get(dafnyKey);
      return dafnyStringToJs(val);
    }
    return null;
  },
  GetTasks: (m: DafnyModel, key: number) => {
    const dafnyKey = new BigNumber(key);
    if (m.dtor_tasks.contains(dafnyKey)) {
      const val = m.dtor_tasks.get(dafnyKey);
      return seqToArray(val).map((x: any) => toNumber(x));
    }
    return null;
  },
  GetTaskData: (m: DafnyModel, key: number) => {
    const dafnyKey = new BigNumber(key);
    if (m.dtor_taskData.contains(dafnyKey)) {
      const val = m.dtor_taskData.get(dafnyKey);
      return taskToJson(val);
    }
    return null;
  },
  GetTags: (m: DafnyModel, key: number) => {
    const dafnyKey = new BigNumber(key);
    if (m.dtor_tags.contains(dafnyKey)) {
      const val = m.dtor_tags.get(dafnyKey);
      return tagToJson(val);
    }
    return null;
  },
  GetNextListId: (m: DafnyModel) => toNumber(m.dtor_nextListId),
  GetNextTaskId: (m: DafnyModel) => toNumber(m.dtor_nextTaskId),
  GetNextTagId: (m: DafnyModel) => toNumber(m.dtor_nextTagId),

  // AppCore functions
  EffectInit: (versions: Record<string, number>, models: Record<string, Model>) => TodoMultiProjectEffectAppCore.__default.EffectInit(((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), new BigNumber(v)); } return m; })(versions), ((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), modelFromJson(v)); } return m; })(models)),
  EffectStep: (es: DafnyEffectState, event: DafnyEvent) => TodoMultiProjectEffectAppCore.__default.EffectStep(es, event),
  EffectIsOnline: (es: DafnyEffectState) => TodoMultiProjectEffectAppCore.__default.EffectIsOnline(es),
  EffectIsIdle: (es: DafnyEffectState) => TodoMultiProjectEffectAppCore.__default.EffectIsIdle(es),
  EffectHasPending: (es: DafnyEffectState) => TodoMultiProjectEffectAppCore.__default.EffectHasPending(es),
  EffectPendingCount: (es: DafnyEffectState) => toNumber(TodoMultiProjectEffectAppCore.__default.EffectPendingCount(es)),
  EffectIsDispatching: (es: DafnyEffectState) => TodoMultiProjectEffectAppCore.__default.EffectIsDispatching(es),
  EffectGetClient: (es: DafnyEffectState) => TodoMultiProjectEffectAppCore.__default.EffectGetClient(es),
  EffectGetMultiModel: (es: DafnyEffectState) => TodoMultiProjectEffectAppCore.__default.EffectGetMultiModel(es),
  EffectGetBaseVersions: (es: DafnyEffectState) => TodoMultiProjectEffectAppCore.__default.EffectGetBaseVersions(es),
  EffectGetPending: (es: DafnyEffectState) => seqToArray(TodoMultiProjectEffectAppCore.__default.EffectGetPending(es)).map(x => multiactionToJson(x)),
  EffectUserAction: (action: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.EffectUserAction(action),
  EffectSingleUserAction: (projectId: string, action: DafnyAction) => TodoMultiProjectEffectAppCore.__default.EffectSingleUserAction(_dafny.Seq.UnicodeFromString(projectId), action),
  GetDeletedTaskIds: (m: DafnyModel) => TodoMultiProjectEffectAppCore.__default.GetDeletedTaskIds(m),
  EffectDispatchAccepted: (newVersions: Record<string, number>, newModels: Record<string, Model>) => TodoMultiProjectEffectAppCore.__default.EffectDispatchAccepted(((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), new BigNumber(v)); } return m; })(newVersions), ((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), modelFromJson(v)); } return m; })(newModels)),
  EffectDispatchConflict: (freshVersions: Record<string, number>, freshModels: Record<string, Model>) => TodoMultiProjectEffectAppCore.__default.EffectDispatchConflict(((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), new BigNumber(v)); } return m; })(freshVersions), ((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), modelFromJson(v)); } return m; })(freshModels)),
  EffectDispatchRejected: (freshVersions: Record<string, number>, freshModels: Record<string, Model>) => TodoMultiProjectEffectAppCore.__default.EffectDispatchRejected(((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), new BigNumber(v)); } return m; })(freshVersions), ((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), modelFromJson(v)); } return m; })(freshModels)),
  EffectRealtimeUpdate: (projectId: string, version: number, model: DafnyModel) => TodoMultiProjectEffectAppCore.__default.EffectRealtimeUpdate(_dafny.Seq.UnicodeFromString(projectId), new BigNumber(version), model),
  EffectNetworkError: () => TodoMultiProjectEffectAppCore.__default.EffectNetworkError(),
  EffectNetworkRestored: () => TodoMultiProjectEffectAppCore.__default.EffectNetworkRestored(),
  EffectManualGoOffline: () => TodoMultiProjectEffectAppCore.__default.EffectManualGoOffline(),
  EffectManualGoOnline: () => TodoMultiProjectEffectAppCore.__default.EffectManualGoOnline(),
  EffectTick: () => TodoMultiProjectEffectAppCore.__default.EffectTick(),
  EffectIsNoOp: (cmd: DafnyCommand) => TodoMultiProjectEffectAppCore.__default.EffectIsNoOp(cmd),
  EffectIsSendDispatch: (cmd: DafnyCommand) => TodoMultiProjectEffectAppCore.__default.EffectIsSendDispatch(cmd),
  EffectIsFetchFreshState: (cmd: DafnyCommand) => TodoMultiProjectEffectAppCore.__default.EffectIsFetchFreshState(cmd),
  EffectGetTouchedProjects: (cmd: DafnyCommand) => TodoMultiProjectEffectAppCore.__default.EffectGetTouchedProjects(cmd),
  EffectGetBaseVersionsFromCmd: (cmd: DafnyCommand) => TodoMultiProjectEffectAppCore.__default.EffectGetBaseVersionsFromCmd(cmd),
  EffectGetMultiAction: (cmd: DafnyCommand) => TodoMultiProjectEffectAppCore.__default.EffectGetMultiAction(cmd),
  MakeSingleAction: (projectId: string, action: DafnyAction) => TodoMultiProjectEffectAppCore.__default.MakeSingleAction(_dafny.Seq.UnicodeFromString(projectId), action),
  MakeMoveTaskTo: (srcProject: string, dstProject: string, taskId: number, dstList: number, anchor: DafnyPlace) => TodoMultiProjectEffectAppCore.__default.MakeMoveTaskTo(_dafny.Seq.UnicodeFromString(srcProject), _dafny.Seq.UnicodeFromString(dstProject), new BigNumber(taskId), new BigNumber(dstList), anchor),
  MakeCopyTaskTo: (srcProject: string, dstProject: string, taskId: number, dstList: number) => TodoMultiProjectEffectAppCore.__default.MakeCopyTaskTo(_dafny.Seq.UnicodeFromString(srcProject), _dafny.Seq.UnicodeFromString(dstProject), new BigNumber(taskId), new BigNumber(dstList)),
  MakeMoveListTo: (srcProject: string, dstProject: string, listId: number) => TodoMultiProjectEffectAppCore.__default.MakeMoveListTo(_dafny.Seq.UnicodeFromString(srcProject), _dafny.Seq.UnicodeFromString(dstProject), new BigNumber(listId)),
  IsSingleAction: (ma: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.IsSingleAction(ma),
  IsMoveTaskTo: (ma: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.IsMoveTaskTo(ma),
  IsCopyTaskTo: (ma: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.IsCopyTaskTo(ma),
  IsMoveListTo: (ma: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.IsMoveListTo(ma),
  GetTouchedProjects: (ma: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.GetTouchedProjects(ma),
  GetProjectModel: (mm: DafnyMultiModel, projectId: string) => TodoMultiProjectEffectAppCore.__default.GetProjectModel(mm, _dafny.Seq.UnicodeFromString(projectId)),
  FindListForTask: (m: DafnyModel, taskId: number) => TodoMultiProjectEffectAppCore.__default.FindListForTask(m, new BigNumber(taskId)),
  HasProject: (mm: DafnyMultiModel, projectId: string) => TodoMultiProjectEffectAppCore.__default.HasProject(mm, _dafny.Seq.UnicodeFromString(projectId)),
  GetProjectIds: (mm: DafnyMultiModel) => TodoMultiProjectEffectAppCore.__default.GetProjectIds(mm),
  TryMultiStep: (mm: DafnyMultiModel, action: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.TryMultiStep(mm, action),
  MultiRebase: (projectLogs: Record<string, Action[]>, baseVersions: Record<string, number>, action: DafnyMultiAction) => TodoMultiProjectEffectAppCore.__default.MultiRebase(((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), _dafny.Seq.of(...(v || []).map((x: any) => actionFromJson(x)))); } return m; })(projectLogs), ((obj) => { let m = _dafny.Map.Empty; for (const [k, v] of Object.entries(obj || {})) { m = m.update(_dafny.Seq.UnicodeFromString(k), new BigNumber(v)); } return m; })(baseVersions), action),
  MultiCandidates: (mm: DafnyMultiModel, action: DafnyMultiAction) => seqToArray(TodoMultiProjectEffectAppCore.__default.MultiCandidates(mm, action)).map(x => multiactionToJson(x)),

  // Conversion functions
  optionToJson,
  optionFromJson,
  dateToJson,
  dateFromJson,
  taskToJson,
  taskFromJson: taskFromJsonPreprocessed,
  tagToJson,
  tagFromJson,
  projectmodeToJson,
  projectmodeFromJson,
  modelToJson,
  modelFromJson,
  errToJson,
  errFromJson,
  placeToJson,
  placeFromJson,
  listplaceToJson,
  listplaceFromJson,
  actionToJson,
  actionFromJson: actionFromJsonPreprocessed,
  viewmodeToJson,
  viewmodeFromJson,
  smartlisttypeToJson,
  smartlisttypeFromJson,
  resultToJson,
  resultFromJson,
  multiactionToJson,
  multiactionFromJson,
  multimodelToJson,
  multimodelFromJson,
  multierrToJson,
  multierrFromJson,
  multiclientstateToJson,
  multiclientstateFromJson,
  networkstatusToJson,
  networkstatusFromJson,
  effectmodeToJson,
  effectmodeFromJson,
  effectstateToJson,
  effectstateFromJson,
  eventToJson,
  eventFromJson,
  commandToJson,
  commandFromJson,

  // Internal modules for custom extensions
  _internal: { _dafny, TodoDomain, TodoMultiProjectDomain, TodoMultiProjectEffectStateMachine, TodoMultiProjectEffectAppCore } as AppInternal,
};

export default App;
